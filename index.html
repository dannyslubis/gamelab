<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Kemi Kurori: Lab Edukasi</title>
    <style>
        body { 
            background: #1a1a1a; 
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            color: white; 
            font-family: 'Courier New', Courier, monospace; 
        }

        /* Status Bar di luar Map (Fixed di atas) */
        #status-bar {
            width: 300px;
            background: #2c3e50;
            padding: 10px;
            border: 2px solid #fff;
            border-bottom: none;
            box-sizing: border-box;
            font-size: 12px;
        }

        #info-display {
            margin-top: 5px;
            color: #00ffcc;
            font-size: 10px;
            line-height: 1.2;
            min-height: 30px;
        }

        /* Area Game */
        #game-container { 
            position: relative; 
            width: 300px; 
            height: 300px; 
            background-image: url('lab.png'); 
            background-size: contain; 
            background-repeat: no-repeat; 
            image-rendering: pixelated; 
            border: 4px solid #fff; 
            cursor: pointer;
            overflow: hidden;
        }

        #player { 
            position: absolute; 
            width: 45px; 
            height: 45px; 
            transform: translate(-50%, -50%); 
            image-rendering: pixelated; 
            transition: left 1.5s ease-in-out, top 1.5s ease-in-out; 
            z-index: 10; 
            pointer-events: none; 
        }

        /* Zona Interaksi (Tanpa Gambar Melayang) */
        .interact-zone {
            position: absolute;
            background: rgba(255, 255, 255, 0); /* Transparan */
            cursor: pointer;
        }

        #meja-praktikum { position: absolute; left: 90px; top: 180px; width: 135px; height: 35px; }
    </style>
</head>
<body>

    <div id="status-bar">
        <div><strong>Karakter:</strong> Kemi Kurori</div>
        <div><strong>Kapasitas:</strong> <span id="capacity">0/2</span></div>
        <div id="info-display">Info: Klik lemari untuk mengambil alat.</div>
    </div>

    <div id="game-container">
        <img id="player" src="kemikurori.png" style="left: 150px; top: 250px;">

        <div id="zone-beaker" class="interact-zone" style="left: 25px; top: 75px; width: 65px; height: 40px;" 
             data-name="Beaker" data-type="glass" data-info="Beaker: Digunakan untuk menampung dan mengaduk larutan kimia."></div>
        
        <div id="zone-labu" class="interact-zone" style="left: 95px; top: 75px; width: 55px; height: 40px;" 
             data-name="Labu" data-type="glass" data-info="Labu: Digunakan untuk memanaskan atau menyimpan cairan kimia."></div>
        
        <div id="zone-tbreaksi" class="interact-zone" style="left: 155px; top: 75px; width: 65px; height: 40px;" 
             data-name="Tabung Reaksi" data-type="glass" data-info="Tabung Reaksi: Untuk mereaksikan dua atau lebih zat dalam jumlah sedikit."></div>

        <div id="zone-p3k" class="interact-zone" style="left: 245px; top: 175px; width: 35px; height: 35px;" 
             data-name="P3K" data-type="box" data-info="P3K: Kotak pertolongan pertama untuk kecelakaan kerja di laboratorium."></div>

        <div id="zone-apar" class="interact-zone" style="left: 250px; top: 215px; width: 30px; height: 45px;" 
             data-name="APAR" data-type="heavy" data-info="APAR: Alat Pemadam Api Ringan untuk menangani kebakaran kecil secara cepat."></div>

        <div id="meja-praktikum"></div>
    </div>

<script>
    const player = document.getElementById('player');
    const container = document.getElementById('game-container');
    const infoDisplay = document.getElementById('info-display');
    const capacityText = document.getElementById('capacity');
    
    let inventory = [];
    const maxInv = 2;

    // Audio Context
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playClickSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        if (type === 'glass') {
            osc.frequency.setValueAtTime(1000, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
        } else if (type === 'heavy' || type === 'box') {
            osc.frequency.setValueAtTime(200, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        } else {
            osc.frequency.setValueAtTime(600, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
        }
        
        osc.start();
        osc.stop(audioCtx.currentTime + 0.3);
    }

    container.addEventListener('click', (e) => {
        const rect = container.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        // Gerak karakter (Tanpa suara langkah)
        player.src = "Untitled 02-27-2026 02-20-45.gif";
        
        // Flip arah
        const currentX = parseInt(player.style.left) || 150;
        player.style.transform = x < currentX ? "translate(-50%, -50%) scaleX(-1)" : "translate(-50%, -50%) scaleX(1)";

        player.style.left = x + 'px';
        player.style.top = y + 'px';

        setTimeout(() => {
            player.src = "kemikurori.png";
            checkInteraction(e.target);
        }, 1500);
    });

    function checkInteraction(target) {
        if (target.classList.contains('interact-zone')) {
            const id = target.id;
            const name = target.getAttribute('data-name');
            const info = target.getAttribute('data-info');
            const type = target.getAttribute('data-type');

            // Cek apakah item sudah dibawa
            const itemIndex = inventory.indexOf(name);

            if (itemIndex !== -1) {
                // Mengembalikan
                inventory.splice(itemIndex, 1);
                infoDisplay.innerText = `Info: Mengembalikan ${name}.`;
                playClickSound(type);
            } else {
                // Mengambil
                if (inventory.length < maxInv) {
                    inventory.push(name);
                    infoDisplay.innerText = `Info: ${info}`;
                    playClickSound(type);
                } else {
                    infoDisplay.innerText = "Info: Kapasitas penuh! Kembalikan alat dulu.";
                }
            }
        } else if (target.id === 'meja-praktikum') {
            if (inventory.length > 0) {
                const lastItem = inventory[inventory.length - 1];
                if (lastItem === "APAR" || lastItem === "P3K") {
                    infoDisplay.innerText = "Info: APAR/P3K tidak boleh ditaruh di meja reaksi!";
                } else {
                    const dropped = inventory.pop();
                    infoDisplay.innerText = `Info: Meletakkan ${dropped} untuk praktikum.`;
                    playClickSound('default');
                }
            }
        }
        capacityText.innerText = `${inventory.length}/${maxInv}`;
    }
</script>
</body>
</html>
